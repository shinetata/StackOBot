# 代码变更任务记录：PGD ParallelJob 对标 UE TaskGraph 的迁移建议文档

## 任务概述
- 目标：为“将 PGD_Core 框架通过 UnrealCSharp 引入 UE5，并使用 TaskGraph 实现并行化能力”的后续设计提供对标与落地基线。
- 方式：阅读 PGD_Core 的 ParallelJob 与生成的 IQuery 并行入口，抽象其语义与边界，再映射到 UE TaskGraph + UnrealCSharp 的可实现方案（含 ASCII 图与关键文件路径）。

## 关键输入（阅读范围）
- PGD_Core：
  - `src/Extensions/ParallelJob/ParallelManager.cs`
  - `src/Extensions/ParallelJob/ParallelRunner.cs`
  - `src/Extensions/ParallelJob/JobHandle.cs`
  - `src/Query/Generated/IQuery.g1.cs` / `IQuery.g2.cs`
  - 文档：`doc/ParallelJob_机制详解.md`、`doc/ScheduleParallel_非阻塞并行化设计说明.md`
- StackOBot（用于 UnrealCSharp 侧约束映射）：
  - TaskGraph worker 执行 C# 的 PoC（已验证）：`FTaskGraph.cpp` / `TaskGraphProbe.cs`
  - Mono thread attach 封装：`FMonoDomain::EnsureThreadAttached()`

## 关键输出
- 新增文档：`docs/tech/pgd-paralleljob-to-ue-taskgraph-mapping.md`
  - 明确 PGD 的“任务/批次/执行器/阻塞与非阻塞语义”
  - 给出 TaskGraph 适配的最小替换点（替换执行后端，不改 PGD 的切分策略）
  - 汇总 UnrealCSharp 的 worker 进入 C# 的必要条件（attach + 避免重复 attach）
  - 给出能力映射表、ASCII 流程图、Span 使用边界与落地顺序

## 涉及文件清单
- 新增：`docs/tech/pgd-paralleljob-to-ue-taskgraph-mapping.md`
- 新增：`task_record/code_change_task_20260113_114612.md`
- 修改：`task_record/index.md`

## 验证方式与结果
- 目视检查：文档为纯 ASCII 图，无 Mermaid；关键路径引用可在本机定位。

## 回滚方式
- 删除新增文档并移除 `task_record/index.md` 的索引行即可。

