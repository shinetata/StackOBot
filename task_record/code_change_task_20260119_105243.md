# 任务记录：补齐 Task.Run + chunk 并扩展对比输出

## 1. 任务概述
- 目标：补齐 `Task.Run + chunk` 对比组，并在对比运行器中同时输出 TaskGraph、Parallel.For、Task.Run 三条路径的中位数与比值。
- 影响范围：更新 C# 对比代码与运行器输出。

## 2. 聊天与讨论背景
- 用户要求：补齐 Task.Run + chunk，与 Parallel.For 一并进行 C# 常用并行能力的性能对比；并询问 TaskGraph 是否真正参与调度及其差异。

## 3. 设计思路
- 新增 Task.Run 版本：按 `taskCount` 分段，每个任务处理一个 chunk。
- 对比运行器改为三路交错顺序（TG / Parallel.For / Task.Run），并输出各自中位数与比值。

## 4. 关键改动说明
- `CSharpParallelPerf` 新增 Task.Run 计时与 chunk 执行逻辑。
- `TaskGraphVsCSharpPerfRunner` 记录三路数据并输出 `pfMedian` / `trMedian` 与 ratio。

## 5. 关键代码解析
- `RunOnceTaskRunChunked`：创建 `taskCount` 个 Task，每个任务处理 `start..end` 连续区间并返回局部和；完成后汇总。
- 对比顺序按轮次轮换：`TG->PF->TR`、`PF->TR->TG`、`TR->TG->PF`。

## 6. 涉及文件清单
- `Plugins/UnrealCSharp/Script/UE/Library/CSharpParallelPerf.cs`：新增 Task.Run + chunk 对比实现。
- `Plugins/UnrealCSharp/Script/UE/Library/TaskGraphVsCSharpPerfRunner.cs`：扩展为三路对比输出。

## 7. 验证方式与结果
- 目视检查：确认输出包含 `pf`、`tr` 与 `ratioPf/ratioTr` 字段。
- 未在本地运行 UE 或 C# 编译（本次仅实现与静态检查）。
