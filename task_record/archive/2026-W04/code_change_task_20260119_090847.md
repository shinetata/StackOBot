# 代码改动任务记录：新增“TaskGraph vs C# Task”性能对比方案文档

## 1) 任务概述

- 目标：把“TaskGraph native kernel vs C# 高性能 Task”在同一任务上的对比方案与代码示例沉淀为文档，作为后续性能评估与决策依据。
- 影响范围：仅新增文档。

## 2) 聊天与讨论背景

- 用户要求：梳理对比方案，给出可运行级别的代码示例，重点对比同一任务负载下两种并行后端的性能与工程权衡。

## 3) 设计思路

- 先统一工作负载（连续内存遍历 + 原地写回 + sum 汇总），确保对比公平。
- 分别给出：
  - TaskGraph native kernel 的 C#/C++ 入口代码示例
  - C# `Parallel.For` 与 `Task.Run` 的高性能实现示例
- 用权衡表总结调度体系、语义边界、实现成本与风险点。
- 给出明确结论与原则（PGD 负责切分，UE 负责调度）。

## 4) 关键改动说明

- 新增文档 `docs/tech/pgd-taskgraph-vs-csharp-task-performance.md`：
  - 明确对比范围与统一负载
  - 给出两种方案的代码示例与权衡表
  - 输出结论与 Golden Rule

## 5) 涉及文件清单

- 新增：`docs/tech/pgd-taskgraph-vs-csharp-task-performance.md`
- 新增：`task_record/archive/2026-W04/code_change_task_20260119_090847.md`（本记录）
- 修改：`task_record/index.md`

## 6) 验证方式与结果

- 验证方式：目视检查文档结构、代码示例完整性、结论与既有 B3/TaskGraph 口径一致。
- 结果：通过。

