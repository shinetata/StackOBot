# 任务记录：UE Tasks 最小并行实现（ExecuteUeParallel）

## 1. 任务概述
- 目标：提供基于 UE Tasks 的最小并行实现示例，新增 ExecuteUeParallel 扩展方法与对应 internal call。
- 范围：新增 C++ internal call 与 C# 桥接/扩展方法；不改 PGD.dll。

## 2. 聊天与讨论背景
- 用户要求：不用 FTasksSlice_ExecuteBatchWithHandlerImplementation；接口名改为 ExecuteUeParallel；避免冗余设计，性能优先。
- PGD.dll 已引入工程，IQuery 定义来自外部库。

## 3. 设计思路
- 使用 UE::Tasks 批量调度，C++ 侧回调 C# 的 ExecuteTask。
- C# 侧通过 runner 按 chunk 分配任务，保持最小逻辑与最少分配。

## 4. 关键改动说明
- 新增 FTasksQuery internal call，提供 ExecuteBatch 调度入口。
- 新增 C# internal call 绑定与批处理桥接。
- 新增 ExecuteUeParallel 扩展方法（IQuery<T1> / IQuery<T1,T2>）。

## 5. 关键代码解析
- C++：在 UE Tasks worker 上调用托管 ExecuteTask(thunk)。
- C#：runner 以 stride 方式遍历 chunk 列表，实现并行遍历。

## 6. 涉及文件清单
- 新增：`Plugins/UnrealCSharp/Source/UnrealCSharp/Private/Domain/InternalCall/FTasksQuery.cpp`
- 新增：`Plugins/UnrealCSharp/Script/UE/Library/FTasksQueryImplementation.cs`
- 新增：`Plugins/UnrealCSharp/Script/UE/Library/UETasksQueryBatch.cs`
- 新增：`Script/Game/PGD/Parallel/UETasksQueryExtensions.cs`
- 修改：`task_record/index.md`
- 新增：`task_record/archive/2026-W05/code_change_task_20260128_161350.md`

## 7. 验证方式与结果
- 验证方式：未运行（需要 UE Editor/脚本环境）。
- 结果：无。
