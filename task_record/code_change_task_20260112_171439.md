# 代码变更任务记录：沉淀 TaskGraph 并行执行纯 C# 计算的讨论文档

## 任务概述
- 目标：把“UnrealCSharp 是否能支持 C# 侧重任务交给 UE TaskGraph 并行调度（纯计算）”的讨论沉淀成可复用文档，作为后续具体方案设计的基础。
- 范围：仅新增文档与任务记录；不改动任何运行时代码。

## 关键结论（供快速回顾）
- 当前仓库没有对 C# 暴露“投递 managed delegate 到 TaskGraph worker 执行”的现成 API。
- 插件内部确实使用 TaskGraph/AsyncTask（例如编译器线程、部分 internal call 切回 GT），说明引擎侧能力可用。
- 若要支持 A 场景（worker 执行纯 C# 计算），关键不在 TaskGraph，而在：
  - TaskGraph worker 线程必须对 Mono 做 thread attach（`mono_thread_attach`/`mono_jit_thread_attach`）后才能可靠执行托管代码。
  - 建议把“投递的工作”包装为 C# `Task`（或等价的可等待句柄）来管理完成点、异常传播、取消与生命周期。

## 设计表达约束
- 按 `AGENTS.md` 基本原则 #6：图示使用纯 ASCII 框图，不使用 Mermaid。

## 涉及文件清单
- 新增：`docs/tech/unrealcsharp-taskgraph-parallel-csharp.md`
  - 汇总现状、关键门槛（Mono thread attach）、推荐最小架构、流程图与 10000 struct chunk 并行伪代码示例。

## 验证方式与结果
- 目视检查 Markdown：
  - 包含 TL;DR、架构图、流程图、伪代码段，且无 Mermaid。
  - 引用的仓库路径可定位到对应文件（例如 `FCSharpCompilerRunnable.cpp`、`FRegisterArray.cpp`、`SynchronizationContext.cs`）。

## 风险与回滚
- 风险：仅文档内容风险，不影响运行时。
- 回滚：删除 `docs/tech/unrealcsharp-taskgraph-parallel-csharp.md` 并移除索引/记录项即可。

